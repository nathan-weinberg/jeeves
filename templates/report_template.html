<!DOCTYPE html>
<html lang="en">
	<div>
		<p style="text-align: center; font-size: smaller;">Report generated by {{header.user_email_address}} on {{header.date}} using the following search fields: {{header.source}}</p>
	</div>
	<div>
		<table>
			<tr>
				<td><img src="{{summary.chart_url}}" width="500" /></td>
				<td><p><b>Summary:</b></p>
					<ul>
							<li>{{summary.total_success}}</li>
							<li>{{summary.total_unstable}}</li>
							<li>{{summary.total_failure}}</li>
							{% if summary.total_missing %}
							<li>{{summary.total_missing}}</li>
							{% endif %}
							{% if summary.total_aborted %}
							<li>{{summary.total_aborted}}</li>
							{% endif %}
							{% if summary.total_error %}
							<li>{{summary.total_error}}</li>
							{% endif %}
							<li>{{summary.total_bugs}}</li>
							<li>{{summary.total_tickets}}</li>
					</ul>
				</td>
			</tr>
		</table>
	</div>
	<div>
		<table border="1">
			<thead>
				<tr>
					<th style="text-align: center;">OSP Version </th>
					<th style="text-align: center;">Job Name</th>
					<th style="text-align: center;">Last Build Number</th>
					<th style="text-align: center;">Compose</th>
					<th style="text-align: center;">Result</th>
					<th style="text-align: center;">Blockers</th>
				</tr>
			</thead>
			<tbody>
				{% for row in rows %}
				<tr>
					<!-- OSP Version and Job Name -->
					<td style="text-align: center;">{{row.osp_version}}</td>
					<td style="text-align: left;"><a href="{{row.job_url}}">{{row.job_name}}</a></td>	

					<!-- remaining columns (LCB Num, Compose, Result, Blockers) all dependent on result value -->
					<!-- LCB is "SUCCESS" -->
					{% if row.lcb_result == "SUCCESS" %}
						<td style="text-align: center;"><a href="{{row.lcb_url}}">{{row.lcb_num}}</a></td>
						<td style="text-align: center;">{{row.compose}}</td>
						<td style="text-align: center;" bgcolor="#4646ff"><a href="https://www.youtube.com/watch?v=68ugkg9RePc" style="text-decoration: none; color: #000;">{{row.lcb_result}}</a></td>
						<td style="text-align: center;"><p>N/A</p></td>

					<!-- LCB is "UNSTABLE" -->
					{% elif row.lcb_result == "UNSTABLE" %}
						<td style="text-align: center;"><a href="{{row.lcb_url}}">{{row.lcb_num}}</a></td>
						<td style="text-align: center;">{{row.compose}}</td>
						<td style="text-align: center;" bgcolor="#fdd500">{{row.lcb_result}}</td>
						<td>
							<p style="text-align: center;"><b>Bugs</b></p>
							{% for bug in row.bugs %}
								<ul>
								{% if bug.bug_url != None %}
									<li><a href="{{bug.bug_url}}">{{bug.bug_name}}</a></li>
								{% else %}
									<li>{{bug.bug_name}}</li>
								{% endif %}
								</ul>
							{% endfor %}
							<hr>
							<p style="text-align: center;"><b>Tickets</b></p>
							{% for ticket in row.tickets %}
								<ul>
								{% if ticket.ticket_url != None %}
									<li><a href="{{ticket.ticket_url}}">{{ticket.ticket_name}}</a></li>
								{% else %}
									<li>{{ticket.ticket_name}}</li>
								{% endif %}
								</ul>
							{% endfor %}
							<hr>
							<p style="text-align: center;"><b>Other</b></p>
							{% for other in row.other %}
								<ul>
								{% if other.other_url != None %}
									<li><a href="{{other.other_url}}">{{other.other_name}}</a></li>
								{% else %}
									<li>{{other.other_name}}</li>
								{% endif %}
								</ul>
							{% endfor %}
						</td>

					<!-- LCB is "FAILURE" -->
					{% elif row.lcb_result == "FAILURE" %}
						<td style="text-align: center;"><a href="{{row.lcb_url}}">{{row.lcb_num}}</a></td>
						<td style="text-align: center;">{{row.compose}}</td>
						<td style="text-align: center;" bgcolor="#ef2929">{{row.lcb_result}}</td>
						<td>
							<p style="text-align: center;"><b>Bugs</b></p>
							{% for bug in row.bugs %}
								<ul>
								{% if bug.bug_url != None %}
									<li><a href="{{bug.bug_url}}">{{bug.bug_name}}</a></li>
								{% else %}
									<li>{{bug.bug_name}}</li>
								{% endif %}
								</ul>
							{% endfor %}
							<hr>
							<p style="text-align: center;"><b>Tickets</b></p>
							{% for ticket in row.tickets %}
								<ul>
								{% if ticket.ticket_url != None %}
									<li><a href="{{ticket.ticket_url}}">{{ticket.ticket_name}}</a></li>
								{% else %}
									<li>{{ticket.ticket_name}}</li>
								{% endif %}
								</ul>
							{% endfor %}
							<hr>
							<p style="text-align: center;"><b>Other</b></p>
							{% for other in row.other %}
								<ul>
								{% if other.other_url != None %}
									<li><a href="{{other.other_url}}">{{other.other_name}}</a></li>
								{% else %}
									<li>{{other.other_name}}</li>
								{% endif %}
								</ul>
							{% endfor %}
						</td>

					<!-- LCB is set to any other state ('NO_KNOWN_BUILDS', 'ERROR') -->
					{% else %}
						{% if row.lcb_url != None %}
							<td style="text-align: center;"><a href="{{row.lcb_url}}">{{row.lcb_num}}</a></td>
						{% else %}
							<td style="text-align: center;">{{row.lcb_num}}</td>
						{% endif %}
						<td style="text-align: center;">{{row.compose}}</td>
						<td style="text-align: center;" bgcolor="#808080">{{row.lcb_result}}</td>
						<td style="text-align: center;"><p>N/A</p></td>
					{% endif %}
				</tr>
				{% endfor %}
			</tbody>
		</table>
	</div>
	<div>
		<p style="text-align: center; font-size: smaller;"><a href="https://github.com/nathan-weinberg/jeeves">Report generated by Jeeves</a></p>
	</div>
</html>
